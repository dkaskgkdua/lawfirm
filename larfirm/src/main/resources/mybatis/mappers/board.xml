<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="Board">
	
	<select id="getListCount" resultType="_int">
		SELECT COUNT(*)
		FROM BOARD	
	</select>
	
	<select id="selectList" resultType="Board" parameterType="java.util.Map">
		<![CDATA[
		 SELECT ID
		 		, BOARD_TITLE
		 		, BOARD_COUNT
		 		, REGI_ID
		 		, REGI_DT
		 		, RNUM 
		   FROM (
				 SELECT a.ID
		        	   , a.BOARD_TITLE
		           	   , a.BOARD_COUNT
		               , a.REGI_ID
		               , a.REGI_DT 
				 	   , ROWNUM RNUM
				  FROM (
				        SELECT ID
				        	   , BOARD_TITLE
				           	   , BOARD_COUNT
				               , REGI_ID
				               , REGI_DT     
				          FROM BOARD
				         WHERE BOARD_CATEGORY=#{board_category}
				         ORDER BY ID DESC
				        ) a 
				) 
		  WHERE RNUM BETWEEN  #{start} and #{end}
		]]>
	</select>
	
	<update id="readCountUpdate" parameterType="_int">
		UPDATE BOARD
		SET BOARD_READCOUNT = BOARD_READCOUNT +1
		WHERE ID=#{id}
	</update>
	
	
	<select id="getDetail" resultType="Board" parameterType="_int">
		SELECT ID,
			   BOARD_CATEGORY,
			   BOARD_TITLE,
			   BOARD_CONTENT,
			   REGI_ID,
			   REGI_DT			   
		FROM BOARD
		WHERE ID=#{id}
	</select>



	<insert id="insert" parameterType="Board">
		INSERT INTO BOARD (ID, BOARD_CATEGORY, BOARD_TITLE, BOARD_CONTENT, BOARD_COUNT, BOARD_RE_REF, BOARD_RE_LEV, BOARD_RE_SEQ, REGI_ID, REGI_DT, UPDT_ID, UPDT_DT)
		VALUES(#{id},#{board_category},#{board_title},#{board_content},0,
			 0,0,0,#{regi_id},SYSDATE,#{updt_id},SYSDATE)
	</insert>
	
	<!-- <update id="updateBoard" parameterType="Board">
		UPDATE BOARD
		SET BTITLE=#{bTitle}
		   ,BCONTENT=#{bContent}
		   ,ORIGINAL_FILENAME=#{originalFileName}
		   ,RENAME_FILENAME=#{renameFileName}
		   ,B_MODIFY_DATE=SYSDATE
		WHERE BID=#{bId}
	</update>

	<update id="deleteBoard" parameterType="_int">
		UPDATE BOARD
		SET B_STATUS='N'
		WHERE BID=#{bId}
	</update>
	
	<select id="selectTopList" resultMap="boardResultSet">
		<![CDATA[
		SELECT *
		FROM (SELECT *
			  FROM board
			  ORDER BY BCOUNT desc)
		WHERE ROWNUM <= 5
		]]>
	</select>
	
	<select id="selectReplyList" parameterType="_int" resultMap="replyResultSet">
		SELECT *
		FROM REPLY
		WHERE REF_BID=#{bId}
		AND R_STATUS='Y'
		ORDER BY RID DESC
	</select>

	<insert id="insertReply" parameterType="Reply">
		INSERT INTO REPLY VALUES
		(SEQ_RID.NEXTVAL,#{rContent},#{refBid},#{rWriter},SYSDATE,SYSDATE,DEFAULT)
	</insert> -->
</mapper>










